<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manpower Assignment</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary-blue: #0056b3;
            --secondary-orange: #ff8c00;
            --light-blue: #e3f2fd;
            --light-orange: #fff3e0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
        }
        
        .navbar {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-orange) 100%);
        }
        
        .nav-tabs .nav-link {
            color: #495057;
            font-weight: 500;
        }
        
        .nav-tabs .nav-link.active {
            color: var(--primary-blue);
            border-bottom: 3px solid var(--secondary-orange);
            background-color: transparent;
        }
        
        .card {
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            border: none;
        }
        
        .card-header {
            background: linear-gradient(120deg, var(--light-blue) 0%, var(--light-orange) 100%);
            font-weight: 600;
            border-radius: 10px 10px 0 0 !important;
        }
        
        .btn-primary {
            background-color: var(--primary-blue);
            border-color: var(--primary-blue);
        }
        
        .btn-warning {
            background-color: var(--secondary-orange);
            border-color: var(--secondary-orange);
            color: white;
        }
        
        .btn-outline-primary {
            color: var(--primary-blue);
            border-color: var(--primary-blue);
        }
        
        .btn-outline-primary:hover {
            background-color: var(--primary-blue);
            color: white;
        }
        
        .logo-container {
            background-color: white;
            border-radius: 10px;
            padding: 10px;
            display: inline-block;
            margin-right: 15px;
        }
        
        .stats-card {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .stats-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-blue);
        }
        
        .stats-title {
            font-size: 0.9rem;
            color: #6c757d;
        }
        
        .blue-card {
            background-color: var(--light-blue);
            border-left: 4px solid var(--primary-blue);
        }
        
        .orange-card {
            background-color: var(--light-orange);
            border-left: 4px solid var(--secondary-orange);
        }
        
        .table thead th {
            background-color: var(--primary-blue);
            color: white;
        }
        
        .badge-inhouse {
            background-color: #28a745;
        }
        
        .badge-qiwa {
            background-color: #17a2b8;
        }
        
        .badge-local {
            background-color: #6c757d;
        }
        
        .phase-pre {
            background-color: #e3f2fd;
        }
        
        .phase-main {
            background-color: #fff3e0;
        }
        
        .phase-post {
            background-color: #e8f5e9;
        }
        
        .filter-section {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .dashboard-chart {
            height: 300px;
            margin-bottom: 30px;
        }
        
        .tab-pane {
            padding: 20px 0;
        }
        
        .import-export-box {
            border: 2px dashed #ced4da;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
            background-color: #f8f9fa;
            transition: all 0.3s;
        }
        
        .import-export-box:hover {
            border-color: var(--primary-blue);
            background-color: #e9ecef;
        }
        
        .modal-content {
            border-radius: 10px;
        }
        
        .form-label {
            font-weight: 500;
        }
        
        #fileInput {
            display: none;
        }
        
        .file-upload-btn {
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <div class="d-flex align-items-center">
                <div class="logo-container">
                    <img src="https://lh3.googleusercontent.com/d/1oQr4RoR9ON5vK6U_oIN2hW0HdnpEloO8" height="40" alt="KANOOZ Logo">
                </div>
                <span class="navbar-brand mb-0 h1">Manpower Assignment</span>
            </div>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container-fluid mt-4">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard" type="button" role="tab">Dashboard</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="manpower-tab" data-bs-toggle="tab" data-bs-target="#manpower" type="button" role="tab">Manpower</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="projects-tab" data-bs-toggle="tab" data-bs-target="#projects" type="button" role="tab">Projects</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="assignment-tab" data-bs-toggle="tab" data-bs-target="#assignment" type="button" role="tab">Auto Assignment</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="shortage-tab" data-bs-toggle="tab" data-bs-target="#shortage" type="button" role="tab">Manpower Shortage</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="export-tab" data-bs-toggle="tab" data-bs-target="#export" type="button" role="tab">Export</button>
            </li>
        </ul>

        <div class="tab-content" id="myTabContent">
            <!-- Dashboard Tab -->
            <div class="tab-pane fade show active" id="dashboard" role="tabpanel">
                <div class="row mt-4">
                    <div class="col-md-3">
                        <div class="stats-card blue-card">
                            <div class="stats-number" id="totalManpower">142</div>
                            <div class="stats-title">Total Manpower</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stats-card orange-card">
                            <div class="stats-number" id="totalProjects">18</div>
                            <div class="stats-title">Active Projects</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stats-card blue-card">
                            <div class="stats-number" id="utilizationRate">87%</div>
                            <div class="stats-title">Utilization Rate</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stats-card orange-card">
                            <div class="stats-number" id="shortageAlert">23</div>
                            <div class="stats-title">Shortage Alert</div>
                        </div>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Manpower by Craft</div>
                            <div class="card-body">
                                <canvas id="craftChart" class="dashboard-chart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Project Timeline</div>
                            <div class="card-body">
                                <canvas id="timelineChart" class="dashboard-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">Recent Assignments</div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover" id="recentAssignmentsTable">
                                        <thead>
                                            <tr>
                                                <th>Project</th>
                                                <th>Phase</th>
                                                <th>Manpower</th>
                                                <th>Craft</th>
                                                <th>Start Date</th>
                                                <th>End Date</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Will be populated dynamically -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Manpower Tab -->
            <div class="tab-pane fade" id="manpower" role="tabpanel">
                <div class="row mt-4">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <span>Manpower List</span>
                                <div>
                                    <button class="btn btn-sm btn-primary me-2" data-bs-toggle="modal" data-bs-target="#addManpowerModal"><i class="fas fa-plus me-1"></i> Add Manpower</button>
                                    <button class="btn btn-sm btn-outline-primary" id="importManpowerBtn"><i class="fas fa-file-import me-1"></i> Import from Excel</button>
                                    <input type="file" id="manpowerFileInput" accept=".xlsx, .csv" style="display: none;">
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="import-export-box">
                                    <i class="fas fa-file-excel fa-3x text-success mb-3"></i>
                                    <h5>Import Manpower Data</h5>
                                    <p class="text-muted">Drag and drop an Excel file here or click to browse</p>
                                    <p class="text-muted small">Supported formats: .xlsx, .csv</p>
                                    <button class="btn btn-primary mt-2" id="manpowerUploadBtn">Browse Files</button>
                                </div>

                                <div class="table-responsive">
                                    <table class="table table-hover" id="manpowerTable">
                                        <thead>
                                            <tr>
                                                <th>Name</th>
                                                <th>Badge</th>
                                                <th>Company</th>
                                                <th>Craft</th>
                                                <th>Joining Date</th>
                                                <th>Release Date</th>
                                                <th>Vacation In</th>
                                                <th>Vacation Out</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Will be populated dynamically -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Projects Tab -->
            <div class="tab-pane fade" id="projects" role="tabpanel">
                <div class="row mt-4">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <span>Projects List</span>
                                <div>
                                    <button class="btn btn-sm btn-primary me-2" data-bs-toggle="modal" data-bs-target="#addProjectModal"><i class="fas fa-plus me-1"></i> Add Project</button>
                                    <button class="btn btn-sm btn-outline-primary" id="importProjectBtn"><i class="fas fa-file-import me-1"></i> Import from Excel</button>
                                    <input type="file" id="projectFileInput" accept=".xlsx, .csv" style="display: none;">
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="import-export-box">
                                    <i class="fas fa-file-excel fa-3x text-success mb-3"></i>
                                    <h5>Import Project Data</h5>
                                    <p class="text-muted">Drag and drop an Excel file here or click to browse</p>
                                    <p class="text-muted small">Supported formats: .xlsx, .csv</p>
                                    <button class="btn btn-primary mt-2" id="projectUploadBtn">Browse Files</button>
                                </div>

                                <div class="table-responsive">
                                    <table class="table table-hover" id="projectTable">
                                        <thead>
                                            <tr>
                                                <th>Project Name</th>
                                                <th>Cost Center</th>
                                                <th>Department</th>
                                                <th>Pre Phase</th>
                                                <th>Main Phase</th>
                                                <th>Post Phase</th>
                                                <th>Status</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Will be populated dynamically -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Auto Assignment Tab -->
            <div class="tab-pane fade" id="assignment" role="tabpanel">
                <div class="row mt-4">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <span>Auto Assignment Results</span>
                                <button class="btn btn-sm btn-primary" id="runAssignment">
                                    <i class="fas fa-cogs me-1"></i> Run Auto Assignment
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="alert alert-info">
                                    <i class="fas fa-info-circle me-2"></i> The system will assign manpower to projects based on availability, skills, and priority (In-house > Qiwa > Local Hire)
                                </div>

                                <div class="table-responsive">
                                    <table class="table table-hover" id="assignmentTable">
                                        <thead>
                                            <tr>
                                                <th>Project/Phase</th>
                                                <th>Required Craft</th>
                                                <th>Assigned Manpower</th>
                                                <th>Company</th>
                                                <th>Dates</th>
                                                <th>Status</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Will be populated dynamically -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Shortage Tab -->
            <div class="tab-pane fade" id="shortage" role="tabpanel">
                <div class="row mt-4">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                Manpower Shortage Report
                            </div>
                            <div class="card-body">
                                <div class="filter-section">
                                    <h5>Filter Shortage Forecast</h5>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <label for="shortagePeriod" class="form-label">Select Period:</label>
                                            <select class="form-select" id="shortagePeriod">
                                                <option value="1">Next 1 Month</option>
                                                <option value="2">Next 2 Months</option>
                                                <option value="3">Next 3 Months</option>
                                                <option value="4">Next 4 Months</option>
                                                <option value="5">Next 5 Months</option>
                                                <option value="6" selected>Next 6 Months</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="craftFilter" class="form-label">Filter by Craft:</label>
                                            <select class="form-select" id="craftFilter">
                                                <option value="all" selected>All Crafts</option>
                                                <option value="Technician">Technician</option>
                                                <option value="Welder">Welder</option>
                                                <option value="Supervisor">Supervisor</option>
                                                <option value="Engineer">Engineer</option>
                                                <option value="Operator">Operator</option>
                                            </select>
                                        </div>
                                    </div>
                                    <button class="btn btn-primary mt-3" id="applyFiltersBtn"><i class="fas fa-filter me-1"></i> Apply Filters</button>
                                </div>

                                <div class="table-responsive">
                                    <table class="table table-hover" id="shortageTable">
                                        <thead>
                                            <tr>
                                                <th>Craft</th>
                                                <th>Period</th>
                                                <th>Demand</th>
                                                <th>Available</th>
                                                <th>Shortage</th>
                                                <th>Status</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Will be populated dynamically -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Export Tab -->
            <div class="tab-pane fade" id="export" role="tabpanel">
                <div class="row mt-4">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                Export Data
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="card h-100">
                                            <div class="card-header">Export Assignment Data</div>
                                            <div class="card-body text-center">
                                                <i class="fas fa-user-check fa-3x text-primary mb-3"></i>
                                                <h5>Manpower Assignment Report</h5>
                                                <p class="text-muted">Export the complete assignment details with manpower names allocated to each project</p>
                                                <button class="btn btn-primary mt-3" id="exportAssignmentBtn"><i class="fas fa-file-export me-1"></i> Export to Excel</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card h-100">
                                            <div class="card-header">Export Shortage Data</div>
                                            <div class="card-body text-center">
                                                <i class="fas fa-exclamation-triangle fa-3x text-warning mb-3"></i>
                                                <h5>Manpower Shortage Report</h5>
                                                <p class="text-muted">Export the craft-wise shortage details with timelines and requirements</p>
                                                <button class="btn btn-primary mt-3" id="exportShortageBtn"><i class="fas fa-file-export me-1"></i> Export to Excel</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mt-4">
                                    <div class="col-md-12">
                                        <div class="import-export-box">
                                            <i class="fas fa-file-excel fa-3x text-success mb-3"></i>
                                            <h5>Custom Export</h5>
                                            <p class="text-muted">Select data range and parameters for customized export</p>
                                            <div class="row justify-content-center">
                                                <div class="col-md-5">
                                                    <label class="form-label">Start Date</label>
                                                    <input type="date" class="form-control" id="exportStartDate">
                                                </div>
                                                <div class="col-md-5">
                                                    <label class="form-label">End Date</label>
                                                    <input type="date" class="form-control" id="exportEndDate">
                                                </div>
                                            </div>
                                            <button class="btn btn-primary mt-3" id="generateCustomReportBtn"><i class="fas fa-file-export me-1"></i> Generate Custom Report</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Manpower Modal -->
    <div class="modal fade" id="addManpowerModal" tabindex="-1" aria-labelledby="addManpowerModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addManpowerModalLabel">Add New Manpower</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="manpowerForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="name" class="form-label">Name</label>
                                    <input type="text" class="form-control" id="name" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="badge" class="form-label">Badge ID</label>
                                    <input type="text" class="form-control" id="badge" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="company" class="form-label">Company</label>
                                    <select class="form-select" id="company" required>
                                        <option value="">Select Company</option>
                                        <option value="In-house">In-house</option>
                                        <option value="Qiwa">Qiwa</option>
                                        <option value="Local Hire">Local Hire</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="craft" class="form-label">Craft</label>
                                    <select class="form-select" id="craft" required>
                                        <option value="">Select Craft</option>
                                        <option value="Technician">Technician</option>
                                        <option value="Welder">Welder</option>
                                        <option value="Supervisor">Supervisor</option>
                                        <option value="Engineer">Engineer</option>
                                        <option value="Operator">Operator</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="joiningDate" class="form-label">Joining Date</label>
                                    <input type="date" class="form-control" id="joiningDate" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="releaseDate" class="form-label">Release Date</label>
                                    <input type="date" class="form-control" id="releaseDate">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="vacationIn" class="form-label">Vacation In</label>
                                    <input type="date" class="form-control" id="vacationIn">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="vacationOut" class="form-label">Vacation Out</label>
                                    <input type="date" class="form-control" id="vacationOut">
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveManpowerBtn">Save Manpower</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Project Modal -->
    <div class="modal fade" id="addProjectModal" tabindex="-1" aria-labelledby="addProjectModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addProjectModalLabel">Add New Project</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="projectForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="projectName" class="form-label">Project Name</label>
                                    <input type="text" class="form-control" id="projectName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="costCenter" class="form-label">Cost Center</label>
                                    <input type="text" class="form-control" id="costCenter" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="department" class="form-label">Department</label>
                                    <select class="form-select" id="department" required>
                                        <option value="">Select Department</option>
                                        <option value="Operations">Operations</option>
                                        <option value="Construction">Construction</option>
                                        <option value="Maintenance">Maintenance</option>
                                        <option value="Engineering">Engineering</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="status" class="form-label">Status</label>
                                    <select class="form-select" id="status" required>
                                        <option value="Planning">Planning</option>
                                        <option value="Active">Active</option>
                                        <option value="Completed">Completed</option>
                                        <option value="On Hold">On Hold</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <h6 class="mt-4 mb-3">Phase Details</h6>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="prePhaseStart" class="form-label">Pre Phase Start</label>
                                    <input type="date" class="form-control" id="prePhaseStart">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="prePhaseEnd" class="form-label">Pre Phase End</label>
                                    <input type="date" class="form-control" id="prePhaseEnd">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="prePhaseManpower" class="form-label">Manpower Required</label>
                                    <input type="number" class="form-control" id="prePhaseManpower" min="0">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="mainPhaseStart" class="form-label">Main Phase Start</label>
                                    <input type="date" class="form-control" id="mainPhaseStart">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="mainPhaseEnd" class="form-label">Main Phase End</label>
                                    <input type="date" class="form-control" id="mainPhaseEnd">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="mainPhaseManpower" class="form-label">Manpower Required</label>
                                    <input type="number" class="form-control" id="mainPhaseManpower" min="0">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="postPhaseStart" class="form-label">Post Phase Start</label>
                                    <input type="date" class="form-control" id="postPhaseStart">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="postPhaseEnd" class="form-label">Post Phase End</label>
                                    <input type="date" class="form-control" id="postPhaseEnd">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="postPhaseManpower" class="form-label">Manpower Required</label>
                                    <input type="number" class="form-control" id="postPhaseManpower" min="0">
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveProjectBtn">Save Project</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Data storage
        let manpowerData = [];
        let projectData = [];
        let assignmentData = [];
        let shortageData = [];

        // Initialize charts and data
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize with sample data
            initializeSampleData();
            
            // Render all tables
            renderManpowerTable();
            renderProjectTable();
            renderAssignmentTable();
            renderShortageTable();
            renderRecentAssignments();
            
            // Initialize charts
            initializeCharts();
            
            // Set up event listeners
            setupEventListeners();
        });

        // Initialize with sample data
        function initializeSampleData() {
            // Sample manpower data
            manpowerData = [
                { id: 1, name: 'Ahmed Al-Saud', badge: 'EMP-001', company: 'In-house', craft: 'Technician', 
                  joiningDate: '2020-01-15', releaseDate: '2025-01-15', vacationIn: '2023-07-01', vacationOut: '2023-07-15' },
                { id: 2, name: 'Mohammed Khan', badge: 'EMP-002', company: 'Qiwa', craft: 'Welder', 
                  joiningDate: '2021-03-20', releaseDate: '2024-03-20', vacationIn: '2023-08-10', vacationOut: '2023-08-25' },
                { id: 3, name: 'John Smith', badge: 'EMP-003', company: 'Local Hire', craft: 'Supervisor', 
                  joiningDate: '2022-05-05', releaseDate: '2023-05-05', vacationIn: '2023-12-20', vacationOut: '2024-01-05' }
            ];

            // Sample project data
            projectData = [
                { id: 1, name: 'Refinery Maintenance', costCenter: 'CC-101', department: 'Operations', status: 'Active',
                  prePhase: { start: '2023-08-15', end: '2023-09-30', manpower: 3 },
                  mainPhase: { start: '2023-10-01', end: '2023-11-30', manpower: 5 },
                  postPhase: { start: '2023-12-01', end: '2024-01-15', manpower: 2 } },
                { id: 2, name: 'Pipeline Installation', costCenter: 'CC-102', department: 'Construction', status: 'Planning',
                  prePhase: { start: '2023-09-01', end: '2023-09-30', manpower: 2 },
                  mainPhase: { start: '2023-10-01', end: '2023-12-31', manpower: 8 },
                  postPhase: { start: '2024-01-01', end: '2024-01-31', manpower: 3 } },
                { id: 3, name: 'Plant Shutdown', costCenter: 'CC-103', department: 'Maintenance', status: 'Upcoming',
                  prePhase: { start: '2023-09-10', end: '2023-09-30', manpower: 4 },
                  mainPhase: { start: '2023-10-01', end: '2023-11-15', manpower: 10 },
                  postPhase: { start: '2023-11-16', end: '2023-11-30', manpower: 3 } }
            ];

            // Sample assignment data
            assignmentData = [
                { id: 1, projectId: 1, phase: 'Pre', craft: 'Technician', required: 3, 
                  assigned: ['Ahmed Al-Saud', 'Faisal Rahman', 'Omar Mohammed'], 
                  company: 'In-house', startDate: '2023-08-15', endDate: '2023-09-30', status: 'Assigned' },
                { id: 2, projectId: 2, phase: 'Main', craft: 'Welder', required: 2, 
                  assigned: ['Mohammed Khan', 'Salim Ahmed'], 
                  company: 'Qiwa', startDate: '2023-10-01', endDate: '2023-12-31', status: 'Assigned' },
                { id: 3, projectId: 3, phase: 'Post', craft: 'Supervisor', required: 1, 
                  assigned: ['John Smith'], 
                  company: 'Local Hire', startDate: '2023-11-16', endDate: '2023-11-30', status: 'Assigned' }
            ];

            // Sample shortage data
            shortageData = [
                { craft: 'Technician', period: 'Sep 2023 - Feb 2024', demand: 45, available: 32, shortage: 13, status: 'Critical' },
                { craft: 'Welder', period: 'Sep 2023 - Feb 2024', demand: 28, available: 25, shortage: 3, status: 'Moderate' },
                { craft: 'Supervisor', period: 'Sep 2023 - Feb 2024', demand: 15, available: 12, shortage: 3, status: 'Moderate' },
                { craft: 'Engineer', period: 'Sep 2023 - Feb 2024', demand: 20, available: 18, shortage: 2, status: 'Low' }
            ];
        }

        // Render manpower table
        function renderManpowerTable() {
            const tbody = document.querySelector('#manpowerTable tbody');
            tbody.innerHTML = '';
            
            manpowerData.forEach(person => {
                const row = document.createElement('tr');
                
                // Format dates for display
                const joinDate = formatDateForDisplay(person.joiningDate);
                const releaseDate = person.releaseDate ? formatDateForDisplay(person.releaseDate) : 'N/A';
                const vacIn = person.vacationIn ? formatDateForDisplay(person.vacationIn) : 'N/A';
                const vacOut = person.vacationOut ? formatDateForDisplay(person.vacationOut) : 'N/A';
                
                // Determine company badge class
                let badgeClass = '';
                if (person.company === 'In-house') badgeClass = 'badge-inhouse';
                else if (person.company === 'Qiwa') badgeClass = 'badge-qiwa';
                else if (person.company === 'Local Hire') badgeClass = 'badge-local';
                
                row.innerHTML = `
                    <td>${person.name}</td>
                    <td>${person.badge}</td>
                    <td><span class="badge ${badgeClass}">${person.company}</span></td>
                    <td>${person.craft}</td>
                    <td>${joinDate}</td>
                    <td>${releaseDate}</td>
                    <td>${vacIn}</td>
                    <td>${vacOut}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary edit-manpower" data-id="${person.id}"><i class="fas fa-edit"></i></button>
                        <button class="btn btn-sm btn-outline-danger delete-manpower" data-id="${person.id}"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
            
            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.edit-manpower').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    editManpower(id);
                });
            });
            
            document.querySelectorAll('.delete-manpower').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    deleteManpower(id);
                });
            });
        }

        // Render project table
        function renderProjectTable() {
            const tbody = document.querySelector('#projectTable tbody');
            tbody.innerHTML = '';
            
            projectData.forEach(project => {
                const row = document.createElement('tr');
                
                // Format phase dates for display
                const prePhase = project.prePhase ? `${formatDateForDisplay(project.prePhase.start)} to ${formatDateForDisplay(project.prePhase.end)}` : 'N/A';
                const mainPhase = project.mainPhase ? `${formatDateForDisplay(project.mainPhase.start)} to ${formatDateForDisplay(project.mainPhase.end)}` : 'N/A';
                const postPhase = project.postPhase ? `${formatDateForDisplay(project.postPhase.start)} to ${formatDateForDisplay(project.postPhase.end)}` : 'N/A';
                
                // Determine status badge color
                let statusBadge = '';
                if (project.status === 'Active') statusBadge = 'bg-success';
                else if (project.status === 'Planning') statusBadge = 'bg-warning text-dark';
                else if (project.status === 'Upcoming') statusBadge = 'bg-info';
                else if (project.status === 'Completed') statusBadge = 'bg-secondary';
                else if (project.status === 'On Hold') statusBadge = 'bg-danger';
                
                row.innerHTML = `
                    <td>${project.name}</td>
                    <td>${project.costCenter}</td>
                    <td>${project.department}</td>
                    <td>${prePhase}</td>
                    <td>${mainPhase}</td>
                    <td>${postPhase}</td>
                    <td><span class="badge ${statusBadge}">${project.status}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary edit-project" data-id="${project.id}"><i class="fas fa-edit"></i></button>
                        <button class="btn btn-sm btn-outline-danger delete-project" data-id="${project.id}"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
            
            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.edit-project').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    editProject(id);
                });
            });
            
            document.querySelectorAll('.delete-project').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    deleteProject(id);
                });
            });
        }

        // Render assignment table
        function renderAssignmentTable() {
            const tbody = document.querySelector('#assignmentTable tbody');
            tbody.innerHTML = '';
            
            assignmentData.forEach(assignment => {
                const row = document.createElement('tr');
                
                // Find project name
                const project = projectData.find(p => p.id === assignment.projectId);
                const projectName = project ? project.name : 'Unknown Project';
                
                // Format dates for display
                const startDate = formatDateForDisplay(assignment.startDate);
                const endDate = formatDateForDisplay(assignment.endDate);
                
                // Determine status badge color
                let statusBadge = '';
                if (assignment.status === 'Assigned') statusBadge = 'bg-success';
                else if (assignment.status === 'Partial') statusBadge = 'bg-warning text-dark';
                else if (assignment.status === 'Unassigned') statusBadge = 'bg-danger';
                
                row.innerHTML = `
                    <td>${projectName} (${assignment.phase})</td>
                    <td>${assignment.craft} (${assignment.required})</td>
                    <td>${assignment.assigned.join(', ')}</td>
                    <td><span class="badge badge-${assignment.company.toLowerCase().replace(' ', '')}">${assignment.company}</span></td>
                    <td>${startDate} to ${endDate}</td>
                    <td><span class="badge ${statusBadge}">${assignment.status}</span></td>
                `;
                
                tbody.appendChild(row);
            });
        }

        // Render shortage table
        function renderShortageTable() {
            const tbody = document.querySelector('#shortageTable tbody');
            tbody.innerHTML = '';
            
            shortageData.forEach(shortage => {
                const row = document.createElement('tr');
                
                // Determine status badge color
                let statusBadge = '';
                if (shortage.status === 'Critical') statusBadge = 'bg-danger';
                else if (shortage.status === 'Moderate') statusBadge = 'bg-warning text-dark';
                else if (shortage.status === 'Low') statusBadge = 'bg-info';
                
                row.innerHTML = `
                    <td>${shortage.craft}</td>
                    <td>${shortage.period}</td>
                    <td>${shortage.demand}</td>
                    <td>${shortage.available}</td>
                    <td>${shortage.shortage}</td>
                    <td><span class="badge ${statusBadge}">${shortage.status}</span></td>
                `;
                
                tbody.appendChild(row);
            });
        }

        // Render recent assignments
        function renderRecentAssignments() {
            const tbody = document.querySelector('#recentAssignmentsTable tbody');
            tbody.innerHTML = '';
            
            // Get recent assignments (last 3)
            const recentAssignments = assignmentData.slice(0, 3);
            
            recentAssignments.forEach(assignment => {
                const row = document.createElement('tr');
                
                // Find project name
                const project = projectData.find(p => p.id === assignment.projectId);
                const projectName = project ? project.name : 'Unknown Project';
                
                // Format dates for display
                const startDate = formatDateForDisplay(assignment.startDate);
                const endDate = formatDateForDisplay(assignment.endDate);
                
                // Determine phase badge class
                let phaseBadge = '';
                if (assignment.phase === 'Pre') phaseBadge = 'phase-pre';
                else if (assignment.phase === 'Main') phaseBadge = 'phase-main';
                else if (assignment.phase === 'Post') phaseBadge = 'phase-post';
                
                row.innerHTML = `
                    <td>${projectName}</td>
                    <td><span class="badge ${phaseBadge}">${assignment.phase}</span></td>
                    <td>${assignment.assigned[0]}</td>
                    <td>${assignment.craft}</td>
                    <td>${startDate}</td>
                    <td>${endDate}</td>
                `;
                
                tbody.appendChild(row);
            });
        }

        // Initialize charts
        function initializeCharts() {
            // Craft Chart
            const craftCtx = document.getElementById('craftChart').getContext('2d');
            const craftChart = new Chart(craftCtx, {
                type: 'bar',
                data: {
                    labels: ['Technician', 'Welder', 'Supervisor', 'Engineer', 'Operator'],
                    datasets: [{
                        label: 'Manpower by Craft',
                        data: [32, 25, 12, 18, 22],
                        backgroundColor: [
                            'rgba(0, 86, 179, 0.7)',
                            'rgba(255, 140, 0, 0.7)',
                            'rgba(0, 86, 179, 0.5)',
                            'rgba(255, 140, 0, 0.5)',
                            'rgba(0, 86, 179, 0.3)'
                        ],
                        borderColor: [
                            'rgb(0, 86, 179)',
                            'rgb(255, 140, 0)',
                            'rgb(0, 86, 179)',
                            'rgb(255, 140, 0)',
                            'rgb(0, 86, 179)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Timeline Chart
            const timelineCtx = document.getElementById('timelineChart').getContext('2d');
            const timelineChart = new Chart(timelineCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [{
                        label: 'Manpower Demand',
                        data: [65, 59, 80, 81, 56, 55, 70, 75, 90, 95, 85, 70],
                        fill: false,
                        borderColor: 'rgb(255, 140, 0)',
                        tension: 0.1
                    },
                    {
                        label: 'Manpower Supply',
                        data: [70, 62, 75, 78, 60, 58, 72, 70, 82, 80, 78, 75],
                        fill: false,
                        borderColor: 'rgb(0, 86, 179)',
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false
                        }
                    }
                }
            });
        }

        // Set up event listeners
        function setupEventListeners() {
            // Save manpower button
            document.getElementById('saveManpowerBtn').addEventListener('click', saveManpower);
            
            // Save project button
            document.getElementById('saveProjectBtn').addEventListener('click', saveProject);
            
            // Run assignment button
            document.getElementById('runAssignment').addEventListener('click', runAssignment);
            
            // Apply filters button
            document.getElementById('applyFiltersBtn').addEventListener('click', applyFilters);
            
            // Import buttons
            document.getElementById('importManpowerBtn').addEventListener('click', () => {
                document.getElementById('manpowerFileInput').click();
            });
            
            document.getElementById('importProjectBtn').addEventListener('click', () => {
                document.getElementById('projectFileInput').click();
            });
            
            document.getElementById('manpowerUploadBtn').addEventListener('click', () => {
                document.getElementById('manpowerFileInput').click();
            });
            
            document.getElementById('projectUploadBtn').addEventListener('click', () => {
                document.getElementById('projectFileInput').click();
            });
            
            // File input change handlers
            document.getElementById('manpowerFileInput').addEventListener('change', handleManpowerFileImport);
            document.getElementById('projectFileInput').addEventListener('change', handleProjectFileImport);
            
            // Export buttons
            document.getElementById('exportAssignmentBtn').addEventListener('click', exportAssignmentData);
            document.getElementById('exportShortageBtn').addEventListener('click', exportShortageData);
            document.getElementById('generateCustomReportBtn').addEventListener('click', generateCustomReport);
        }

        // Format date for display (dd-mmm-yy)
        function formatDateForDisplay(dateString) {
            if (!dateString) return 'N/A';
            
            const date = new Date(dateString);
            const day = date.getDate().toString().padStart(2, '0');
            const month = date.toLocaleString('default', { month: 'short' });
            const year = date.getFullYear().toString().slice(-2);
            
            return `${day}-${month}-${year}`;
        }

        // Format date for storage (yyyy-mm-dd)
        function formatDateForStorage(dateString) {
            if (!dateString) return null;
            
            const parts = dateString.split('-');
            if (parts.length !== 3) return null;
            
            const day = parts[0];
            const month = parts[1];
            const year = parts[2];
            
            // Convert to yyyy-mm-dd format
            const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            const monthIndex = monthNames.findIndex(m => m.toLowerCase() === month.toLowerCase());
            
            if (monthIndex === -1) return null;
            
            const fullYear = '20' + year; // Assuming years are from 2000 onwards
            return `${fullYear}-${(monthIndex + 1).toString().padStart(2, '0')}-${day.padStart(2, '0')}`;
        }

        // Save manpower
        function saveManpower() {
            const name = document.getElementById('name').value;
            const badge = document.getElementById('badge').value;
            const company = document.getElementById('company').value;
            const craft = document.getElementById('craft').value;
            const joiningDate = document.getElementById('joiningDate').value;
            const releaseDate = document.getElementById('releaseDate').value;
            const vacationIn = document.getElementById('vacationIn').value;
            const vacationOut = document.getElementById('vacationOut').value;
            
            if (!name || !badge || !company || !craft || !joiningDate) {
                alert('Please fill in all required fields');
                return;
            }
            
            const newManpower = {
                id: manpowerData.length > 0 ? Math.max(...manpowerData.map(m => m.id)) + 1 : 1,
                name,
                badge,
                company,
                craft,
                joiningDate,
                releaseDate: releaseDate || null,
                vacationIn: vacationIn || null,
                vacationOut: vacationOut || null
            };
            
            manpowerData.push(newManpower);
            renderManpowerTable();
            
            // Update dashboard stats
            document.getElementById('totalManpower').textContent = manpowerData.length;
            
            // Close modal
            bootstrap.Modal.getInstance(document.getElementById('addManpowerModal')).hide();
            
            // Reset form
            document.getElementById('manpowerForm').reset();
        }

        // Save project
        function saveProject() {
            const name = document.getElementById('projectName').value;
            const costCenter = document.getElementById('costCenter').value;
            const department = document.getElementById('department').value;
            const status = document.getElementById('status').value;
            
            const prePhaseStart = document.getElementById('prePhaseStart').value;
            const prePhaseEnd = document.getElementById('prePhaseEnd').value;
            const prePhaseManpower = document.getElementById('prePhaseManpower').value;
            
            const mainPhaseStart = document.getElementById('mainPhaseStart').value;
            const mainPhaseEnd = document.getElementById('mainPhaseEnd').value;
            const mainPhaseManpower = document.getElementById('mainPhaseManpower').value;
            
            const postPhaseStart = document.getElementById('postPhaseStart').value;
            const postPhaseEnd = document.getElementById('postPhaseEnd').value;
            const postPhaseManpower = document.getElementById('postPhaseManpower').value;
            
            if (!name || !costCenter || !department || !status) {
                alert('Please fill in all required fields');
                return;
            }
            
            const newProject = {
                id: projectData.length > 0 ? Math.max(...projectData.map(p => p.id)) + 1 : 1,
                name,
                costCenter,
                department,
                status,
                prePhase: prePhaseStart && prePhaseEnd ? {
                    start: prePhaseStart,
                    end: prePhaseEnd,
                    manpower: parseInt(prePhaseManpower) || 0
                } : null,
                mainPhase: mainPhaseStart && mainPhaseEnd ? {
                    start: mainPhaseStart,
                    end: mainPhaseEnd,
                    manpower: parseInt(mainPhaseManpower) || 0
                } : null,
                postPhase: postPhaseStart && postPhaseEnd ? {
                    start: postPhaseStart,
                    end: postPhaseEnd,
                    manpower: parseInt(postPhaseManpower) || 0
                } : null
            };
            
            projectData.push(newProject);
            renderProjectTable();
            
            // Update dashboard stats
            document.getElementById('totalProjects').textContent = projectData.length;
            
            // Close modal
            bootstrap.Modal.getInstance(document.getElementById('addProjectModal')).hide();
            
            // Reset form
            document.getElementById('projectForm').reset();
        }

        // Edit manpower
        function editManpower(id) {
            // Find the manpower record
            const manpower = manpowerData.find(m => m.id === parseInt(id));
            if (!manpower) return;
            
            // Fill the form with existing data
            document.getElementById('name').value = manpower.name;
            document.getElementById('badge').value = manpower.badge;
            document.getElementById('company').value = manpower.company;
            document.getElementById('craft').value = manpower.craft;
            document.getElementById('joiningDate').value = manpower.joiningDate;
            document.getElementById('releaseDate').value = manpower.releaseDate || '';
            document.getElementById('vacationIn').value = manpower.vacationIn || '';
            document.getElementById('vacationOut').value = manpower.vacationOut || '';
            
            // Change button text
            document.getElementById('saveManpowerBtn').textContent = 'Update Manpower';
            
            // Store the ID in the button for update
            document.getElementById('saveManpowerBtn').setAttribute('data-id', id);
            
            // Show the modal
            const modal = new bootstrap.Modal(document.getElementById('addManpowerModal'));
            modal.show();
        }

        // Edit project
        function editProject(id) {
            // Find the project record
            const project = projectData.find(p => p.id === parseInt(id));
            if (!project) return;
            
            // Fill the form with existing data
            document.getElementById('projectName').value = project.name;
            document.getElementById('costCenter').value = project.costCenter;
            document.getElementById('department').value = project.department;
            document.getElementById('status').value = project.status;
            
            // Fill phase data if available
            if (project.prePhase) {
                document.getElementById('prePhaseStart').value = project.prePhase.start;
                document.getElementById('prePhaseEnd').value = project.prePhase.end;
                document.getElementById('prePhaseManpower').value = project.prePhase.manpower;
            }
            
            if (project.mainPhase) {
                document.getElementById('mainPhaseStart').value = project.mainPhase.start;
                document.getElementById('mainPhaseEnd').value = project.mainPhase.end;
                document.getElementById('mainPhaseManpower').value = project.mainPhase.manpower;
            }
            
            if (project.postPhase) {
                document.getElementById('postPhaseStart').value = project.postPhase.start;
                document.getElementById('postPhaseEnd').value = project.postPhase.end;
                document.getElementById('postPhaseManpower').value = project.postPhase.manpower;
            }
            
            // Change button text
            document.getElementById('saveProjectBtn').textContent = 'Update Project';
            
            // Store the ID in the button for update
            document.getElementById('saveProjectBtn').setAttribute('data-id', id);
            
            // Show the modal
            const modal = new bootstrap.Modal(document.getElementById('addProjectModal'));
            modal.show();
        }

        // Delete manpower
        function deleteManpower(id) {
            if (confirm('Are you sure you want to delete this manpower record?')) {
                manpowerData = manpowerData.filter(m => m.id !== parseInt(id));
                renderManpowerTable();
                
                // Update dashboard stats
                document.getElementById('totalManpower').textContent = manpowerData.length;
            }
        }

        // Delete project
        function deleteProject(id) {
            if (confirm('Are you sure you want to delete this project?')) {
                projectData = projectData.filter(p => p.id !== parseInt(id));
                renderProjectTable();
                
                // Update dashboard stats
                document.getElementById('totalProjects').textContent = projectData.length;
            }
        }

        // Run assignment
        function runAssignment() {
            alert('Auto assignment process started. This may take a few moments...');
            
            // Simulate processing time
            setTimeout(function() {
                // This is where you would implement the actual assignment algorithm
                // For now, we'll just use the sample data
                
                alert('Auto assignment completed successfully!');
                
                // Update the assignment table
                renderAssignmentTable();
                
                // Update recent assignments
                renderRecentAssignments();
            }, 2000);
        }

        // Apply filters
        function applyFilters() {
            const period = document.getElementById('shortagePeriod').value;
            const craft = document.getElementById('craftFilter').value;
            
            alert(`Filters applied: Period - ${period} months, Craft - ${craft}`);
            
            // Here you would filter the shortage data based on the selected filters
            // For now, we'll just use the sample data
            renderShortageTable();
        }

        // Handle manpower file import
        function handleManpowerFileImport(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            alert(`Manpower file "${file.name}" imported successfully!`);
            
            // Here you would process the Excel/CSV file and update manpowerData
            // For now, we'll just add a sample record
            manpowerData.push({
                id: manpowerData.length > 0 ? Math.max(...manpowerData.map(m => m.id)) + 1 : 1,
                name: 'Imported Employee',
                badge: 'EMP-IMPORT',
                company: 'In-house',
                craft: 'Technician',
                joiningDate: '2023-01-01',
                releaseDate: '2024-01-01',
                vacationIn: null,
                vacationOut: null
            });
            
            renderManpowerTable();
            
            // Update dashboard stats
            document.getElementById('totalManpower').textContent = manpowerData.length;
            
            // Reset file input
            event.target.value = '';
        }

        // Handle project file import
        function handleProjectFileImport(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            alert(`Project file "${file.name}" imported successfully!`);
            
            // Here you would process the Excel/CSV file and update projectData
            // For now, we'll just add a sample record
            projectData.push({
                id: projectData.length > 0 ? Math.max(...projectData.map(p => p.id)) + 1 : 1,
                name: 'Imported Project',
                costCenter: 'CC-IMPORT',
                department: 'Operations',
                status: 'Planning',
                prePhase: { start: '2023-10-01', end: '2023-10-15', manpower: 2 },
                mainPhase: { start: '2023-10-16', end: '2023-11-15', manpower: 5 },
                postPhase: { start: '2023-11-16', end: '2023-11-30', manpower: 2 }
            });
            
            renderProjectTable();
            
            // Update dashboard stats
            document.getElementById('totalProjects').textContent = projectData.length;
            
            // Reset file input
            event.target.value = '';
        }

        // Export assignment data
        function exportAssignmentData() {
            alert('Assignment data exported to Excel successfully!');
            
            // Here you would implement the actual export functionality
            // using the XLSX library
        }

        // Export shortage data
        function exportShortageData() {
            alert('Shortage data exported to Excel successfully!');
            
            // Here you would implement the actual export functionality
            // using the XLSX library
        }

        // Generate custom report
        function generateCustomReport() {
            const startDate = document.getElementById('exportStartDate').value;
            const endDate = document.getElementById('exportEndDate').value;
            
            if (!startDate || !endDate) {
                alert('Please select both start and end dates');
                return;
            }
            
            alert(`Custom report generated for period: ${startDate} to ${endDate}`);
            
            // Here you would implement the actual custom report generation
            // using the XLSX library
        }
    </script>
</body>
</html>
